_bazel_build() {
    bazel build -c opt wheels
    _status=$?
    bazel shutdown
    if [[ $_status -gt 0 ]]; then
        exit $_status # or call false
    fi
}
build() {
    cd "anki-$pkgver"
    #fixes linker for clang users
    if [ "$CC" = clang ] && [ "$CXX" = 'clang++' ]; then
        export LDSHARED="/usr/bin/clang -shared"
    fi
    # build requires java 11 to work, does not compile with java 17
    export JAVA_HOME="/usr/lib/jvm/java-11-openjdk"
    echo "####################
Beginning compilation... This step is known to be prone to failure by the anki devs.
If the build is failing retry the installation. This usually fixes the problem.
A too slow internet connection can also hinder the dependency fetching process because of hardcoded timeouts in bazel.
If the problem persists consider removing data in ~/.cache/bazel and your AUR manager cache (~/.cache/paru/clone/anki for paru) and retry again.
####################"
    _bazel_build
}
