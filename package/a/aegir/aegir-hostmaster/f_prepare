prepare() {
  patch --directory=hosting_https --strip=1 < hosting_https-pkg-info.patch

  local -A expr=(
    [nginx_stub]='/\/etc\/init.d\/nginx/c \    return "sudo /usr/bin/systemctl try-reload-or-restart httpd.service";''/\/etc\/init.d\/nginx/c \    return "sudo /usr/bin/systemctl try-reload-or-restart httpd.service";'
    [apache_apachectl]='/\/usr\/sbin\/apachectl/,/return/c \    return "sudo /usr/bin/systemctl try-reload-or-restart httpd.service";'
    [apache_apache2ctl]='/\/usr\/sbin\/apache2ctl/,/return/c \    return "sudo /usr/bin/systemctl try-reload-or-restart httpd.service";'
  )
  local -A path=(
    [nginx_stub]="$_pkgname/modules/aegir/hosting/web_server/nginx/hosting_nginx.service.inc $_pkgname/modules/aegir/hosting/web_server/nginx/ssl/hosting_nginx_ssl.service.inc hosting_https/submodules/nginx_https/hosting_nginx_https.service.inc"
    [apache_apachectl]="$_pkgname/modules/aegir/hosting/web_server/ssl/hosting_ssl.service.inc hosting_https/submodules/apache_https/hosting_apache_https.service.inc"
    [apache_apache2ctl]="$_pkgname/modules/aegir/hosting/web_server/hosting_web_server.service.inc"
  )

  for index in "${!expr[@]}"; do
    # Apply word splitting to path string as its a space-separated list of files.
    sed --in-place "${expr[$index]}" ${path[$index]}
  done
}
