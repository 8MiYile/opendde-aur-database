build() {
    cd "${srcdir}/${pkgname}-${pkgver}"

    # Create empty build directory
    mkdir -p build
    cd build
    rm -rf *

    # APBS compilation flags
    APBS_STATIC_BUILD=OFF
    BLA_VENDOR="OpenBLAS"
    BUILD_DOC=ON
    BUILD_TOOLS=ON
    INSTALL_DIR=/usr
    RELEASE_TYPE=Debug
    ENABLE_PYGBE=ON
    ENABLE_BEM=ON
    ENABLE_GEOFLOW=ON
    FETK_VERSION=57195e55351e04ce6ee0ef56a143c996a9aee7e2
    ENABLE_iAPBS=ON
    ENABLE_OPENMP=OFF
    ENABLE_PBAM=OFF
    ENABLE_PBSAM=OFF
    ENABLE_PYTHON=OFF
    ENABLE_TESTS=ON
    GET_NanoShaper=ON
    PYTHON_VERSION="3.10"

    # Configure and compile
    cmake \
        -DCMAKE_INSTALL_INCLUDEDIR="include" \
        -DBUILD_DOC=${BUILD_DOC} \
        -DAPBS_STATIC_BUILD=${APBS_STATIC_BUILD}  \
        -DBUILD_TOOLS=O${BUILD_TOOLS} \
        -DCMAKE_BUILD_TYPE=$RELEASE_TYPE \
        -DCMAKE_INSTALL_PREFIX=$INSTALL_DIR \
        -DENABLE_PYGBE=${ENABLE_PYGBE} \
        -DENABLE_BEM=${ENABLE_BEM} \
        -DENABLE_iAPBS=${ENABLE_iAPBS} \
        -DENABLE_GEOFLOW=${ENABLE_GEOFLOW} \
        -DENABLE_OPENMP=${ENABLE_OPENMP} \
        -DENABLE_PBAM=${ENABLE_PBAM} \
        -DENABLE_PBSAM=${ENABLE_PBSAM} \
        -DENABLE_PYTHON=${ENABLE_PYTHON} \
        -DENABLE_TESTS=${ENABLE_TESTS} \
        -DFETK_VERSION=${FETK_VERSION} \
        -DGET_NanoShaper=${GET_NanoShaper} \
        -DPYTHON_VERSION="${PYTHON_VERSION}" \
        ..

    make
}
