prepare() {
    warning "Installing this package means that you have red, understood and ACCEPTED"
    warning "the license agreement posted at http://developer.amd.com/amd-license-agreement/"
    warning ""
    warning "will sleep 5 sec to make sure you red it :P"
    sleep 5
    warning "Download will take not much time and echo some random letters, prepare yourself"
    
    # Original script from https://github.com/gregvw/amd_sdk/

    # Location from which get nonce and file name from
    URL="http://developer.amd.com/tools-and-sdks/graphics-development/display-library-adl-sdk/"
#     URLDOWN="http://developer.amd.com/amd-license-agreement-appsdk/"
    URLDOWN="http://developer.amd.com/amd-license-agreement/"

    NONCE1_STRING='name="amd_developer_central_downloads_page_nonce"'
    FILE_STRING='name="f"'
    POSTID_STRING='name="post_id"'
    NONCE2_STRING='name="amd_developer_central_nonce"'

#     FORM=`wget -qO - $URL | sed -n '/download-1/,/64-bit/p'`
    FORM=`wget -qO - $URL | sed -n '/download-1/,/${_source}/p'`

    # Get nonce from form
    NONCE1=`echo $FORM | awk -F ${NONCE1_STRING} '{print $2}'`
    NONCE1=`echo $NONCE1 | awk -F'"' '{print $2}'`
    echo $NONCE1

    # get the postid
    POSTID=`echo $FORM | awk -F ${POSTID_STRING} '{print $2}'`
    POSTID=`echo $POSTID | awk -F'"' '{print $2}'`
    echo $POSTID

    # get file name
    FILE=`echo $FORM | awk -F ${FILE_STRING} '{print $2}'`
    FILE=`echo $FILE | awk -F'"' '{print $2}'`
    echo $FILE

    FORM=`wget -qO - $URLDOWN --post-data "amd_developer_central_downloads_page_nonce=${NONCE1}&f=${FILE}&post_id=${POSTID}"`

    NONCE2=`echo $FORM | awk -F ${NONCE2_STRING} '{print $2}'`
    NONCE2=`echo $NONCE2 | awk -F'"' '{print $2}'`
    echo $NONCE2

    wget --content-disposition --trust-server-names $URLDOWN --post-data "amd_developer_central_nonce=${NONCE2}&f=${FILE}" -O ${_source};

        msg "Validating ${_source} files with sha256sum ..."
        echo "${_sha256sums} ${srcdir}/${_source}" | sha256sum -c || exit 1
        
        cd ${srcdir}/
        unzip ${_source}

        sed -i -e '/include/a \#include <wchar.h>' ${srcdir}/include/adl_structures.h
        sed -i -e '/include/a \#include <stdbool.h>' ${srcdir}/include/adl_sdk.h
}
