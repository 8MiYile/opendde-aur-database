build() {
    cd "$srcdir/$pkgname-$pkgver"

    # Delete some directories.
    find . -type d -iname "CVS" | xargs rm -rf 

    # First we need to build lorcon
    tar -xvf lorcon-current.tgz
    cd lorcon
        # Get rid of ownership changes. fakeroot doesn't like it.
        sed -i 's|-o root||' Makefile.in

        CFLAGS="${CFLAGS}" \
        ./configure \
            --prefix=/usr \
            --libdir=/usr/lib \
            --mandir=/usr/share/man \
            --enable-static=no

        make
        make install DESTDIR="$PWD"
    cd ..

    # Fix airpwn files so we can use it with a Python version other than 2.4.
    PYVER=$(python2 -c "import sys;print sys.version[:3]")
    sed -i "s|python2.4|python${PYVER}|" conf.h configure.ac

    autoreconf -ivf

    CFLAGS="${CFLAGS}" \
    CPPFLAGS="-Ilorcon/usr/include" \
    LDFLAGS="-Llorcon/usr/lib" \
    LIBS="-lcrypto" \
    ./configure \
        --prefix=/usr \
        --libdir=/usr/lib

    make
}
