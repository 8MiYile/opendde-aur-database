build() {
  cd $pkgname-$pkgver
  
  local _cmakeargs=(
          -DCMAKE_INSTALL_PREFIX=/usr
          -DCMAKE_INSTALL_LIBEXECDIR=lib/arx
          -DRUNTIME_DATADIR=""
          -DCMAKE_BUILD_TYPE=Release
          -DUNITY_BUILD=ON
          -DINSTALL_SCRIPTS=ON
          -DBUILD_TOOLS=ON
          -DBUILD_TESTS=ON
          -DUSE_NATIVE_FS=ON
          -DUSE_OPENAL=ON
          -DUSE_OPENGL=ON
          -DWITH_SDL=2
          -DWITH_OPENGL=epoxy
  )

  local _blender_api="$(pacman -Sddp --print-format %v blender 2>/dev/null |grep -oP '(?<=\:)[[:digit:]]{1}\.[[:digit:]]{2}(?=\.)')"
  if [[ "$_blender_api" != "" ]]; then
    _cmakeargs+=(
            -DINSTALL_BLENDER_PLUGIN=ON
            -DINSTALL_BLENDER_PLUGINDIR="/usr/share/blender/${_blender_api}/scripts/addons/arx"
    )
  fi

  # -DUNITY_BUILD
  #   produces a more optimized binary, but uses a lot of RAM during
  #   compilation - disable if low on memory.
  # 
  # -DCMAKE_BUILD_TYPE=Release
  #   can be changed to CMAKE_BUILD_TYPE=Debug to get a debug build,
  #   which will run signifincantly slower but enables more runtime
  #   checks and generates better crash reports.
  
  cmake . "${_cmakeargs[@]}"
  make
}
