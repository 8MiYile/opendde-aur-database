prepare() {
	tar -xf data.tar.xz

	cd ${srcdir}/${pkgname}
	git config submodule.src/extensions/default/JSLint/thirdparty/jslint.url "$srcdir/jslint"
	for i in i18n mustache path-utils requirejs text
	do
		git config submodule.src/thirdparty/${i}.url "$srcdir/$i"
	done
	git submodule update --init

	cd ${srcdir}/${pkgname}/src/thirdparty/mustache
	git config submodule.test/spec.url "$srcdir/spec"
	git submodule update --init

	git submodule update --init --recursive

	cd ${srcdir}/brackets-shell
	sed 's/python/python2/' -i gyp/gyp
	sed 's/UnicodeString/icu::UnicodeString/g' -i appshell/appshell_extensions_platform.cpp
	sed '29i\#include <unicode/ucnv.h>' -i appshell/appshell_extensions_platform.h
	sed '29i\#include <unicode/unistr.h>' -i appshell/appshell_extensions_platform.h
	patch -Np1 < $srcdir/648.patch

	mkdir -p downloads
	ln -sf ${srcdir}/cef_binary_${_cef_ver}_linux64_release.zip downloads
	ln -sf ${srcdir}/node-v${_node_ver}-linux-x64.tar.gz downloads
}
