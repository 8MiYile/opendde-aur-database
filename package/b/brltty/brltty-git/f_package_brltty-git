package_brltty-git() {
	depends=(bluez-libs gcc-libs glibc liblouis libspeechd libasound.so
	         libdbus-1.so libexpat.so libgio-2.0.so libglib-2.0.so libgobject-2.0.so
	         libicuuc.so libgpm.so libncursesw.so libsystemd.so pcre2 polkit)
	optdepends=(
	            'at-spi2-core: X11/GNOME Apps accessibility'
	            'brltty-udev-generic: for initializing brltty with generic USB devices'
	            'espeak-ng: espeak-ng driver'
	            'java-runtime: Java support'
	            'libxaw: X11 support'
	            'libxt: X11 support'
	            'libx11: for xbrlapi'
	            'libxfixes: for xbrlapi'
	            'libxtst: for xbrlapi'
	            'ocaml: OCaml support'
	            'python: Python support'
	            'speech-dispatcher: speech-dispatcher driver'
	            'tcl: tcl support'
	)
	provides=(brltty libbrlapi.so)
	conflicts=(brltty)
	backup=(
	        etc/brltty.conf
	        etc/X11/xinit/xinitrc.d/90xbrlapi
	)
	install=brltty-git.install

	cd ${pkgbase%-git}
	# installation does not work reliably with many cores, so set jobs to 1
	make -j1 INSTALL_ROOT="$pkgdir" install
	make -j1 INSTALL_ROOT="$pkgdir" install-systemd
	make -j1 INSTALL_ROOT="$pkgdir" install-udev
	make -j1 INSTALL_ROOT="$pkgdir" install-dracut
	make -j1 INSTALL_ROOT="$pkgdir" install-polkit
	install -vDm 644 Documents/${pkgbase%-git}.conf -t "$pkgdir/etc/"

	# fix directory permission and ownership
	install -vdm 750 -o root -g 102 "$pkgdir/usr/share/polkit-1/rules.d"

	# move generic udev rule, as it applies too broadly
	mv -v "$pkgdir/usr/lib/udev/rules.d/90-brltty-usb-generic.rules" ../
}
