prepare() {
    # extract installer (convert files to lowercase, as DOS does not care)
    innoextract -e -L -d "$srcdir"/setup "setup_battle_isle_${pkgver}_(28043).exe"
    # convert icon
    icotool -x setup/goggame-1207660993.ico
    # create launchers
    sed "s|Exec=battle-isle|& --desert|;s|Name=Battle Isle|&: The Desert|" \
            $pkgname.desktop > battle-isle-desert.desktop
    sed "s|Exec=battle-isle|& --moon|;s|Name=Battle Isle|&: The Moon of Chromos|" \
            $pkgname.desktop > battle-isle-moon.desktop

    cp setup/__support/app/dosboxbi1.conf "$srcdir"
    cp setup/tmp/eula.txt "$srcdir"

    # remove bundled dosbox, windows stuff and gog client files
    rm -rf setup/{app,commonappdata,dosbox,tmp,*.ico,*.dll,goggame-1207660993.*,*.zip,__redist,__support}
}
